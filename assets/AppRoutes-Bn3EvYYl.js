import{r as a,F as V,C as O,j as e,L as w,u as U,a as J,i as D,R as Q,b as y,N as B}from"./index-DU-oLizr.js";const k=()=>{const s=a.useContext(V);if(!s)throw new Error("useFlashcards doit être utilisé à l'intérieur d'un FlashcardProvider");return s},z=()=>{const s=a.useContext(O);if(!s)throw new Error("useCategories doit être utilisé à l'intérieur d'un CategoryProvider");return s},q={speak:(s,r={})=>{if(!("speechSynthesis"in window))return console.error("La synthèse vocale n'est pas supportée par ce navigateur."),!1;window.speechSynthesis.cancel();const t=new SpeechSynthesisUtterance(s);if(t.lang=r.lang||"fr-FR",t.volume=r.volume||1,t.rate=r.rate||1,t.pitch=r.pitch||1,r.onStart&&(t.onstart=r.onStart),r.onEnd&&(t.onend=r.onEnd),r.onError&&(t.onerror=r.onError),r.onPause&&(t.onpause=r.onPause),r.onResume&&(t.onresume=r.onResume),r.voice){const i=speechSynthesis.getVoices().find(n=>n.name===r.voice||n.lang===r.voice);i&&(t.voice=i)}return window.speechSynthesis.speak(t),!0},stop:()=>"speechSynthesis"in window?(window.speechSynthesis.cancel(),!0):!1,getVoices:()=>"speechSynthesis"in window?window.speechSynthesis.getVoices():[]},T=()=>{const[s,r]=a.useState(!1),[t,l]=a.useState([]);a.useEffect(()=>{const d=()=>{const u=q.getVoices().filter(o=>o.lang.startsWith("fr"));l(u)};return d(),window.speechSynthesis.onvoiceschanged=d,()=>{window.speechSynthesis.onvoiceschanged=null}},[]);const i=a.useCallback((d,u={})=>{if(!d)return;const o={lang:"fr-FR",onStart:()=>r(!0),onEnd:()=>r(!1),onError:()=>r(!1)};t.length>0&&(o.voice=t[0].name);const c={...o,...u};q.speak(d,c)},[t]),n=a.useCallback(()=>{q.stop(),r(!1)},[]);return{speak:i,stop:n,speaking:s,voices:t}},M=({flashcard:s,categories:r,onEdit:t,onDelete:l})=>{const[i,n]=a.useState(!1),[d,u]=a.useState(null),{getFlashcardImageUrl:o}=k(),{speak:c,speaking:j}=T();a.useState(()=>{(async()=>{const g=await o(s.imagePath);u(g)})()},[s.imagePath,o]);const x=()=>{n(!i)},v=h=>{h.stopPropagation(),c(s.name)},p=h=>{h.stopPropagation(),t(s.id)},f=h=>{h.stopPropagation(),l(s.id)},m=r.filter(h=>s.categoryIds.includes(h.id));return e.jsx("div",{className:"flippable-card-container",children:e.jsxs("div",{className:`flippable-card ${i?"flipped":""}`,onClick:x,children:[e.jsxs("div",{className:"card-face card-front",children:[e.jsx("h3",{children:s.name}),e.jsx("div",{className:"card-categories",children:m.map(h=>e.jsx(CategoryChip,{category:h,selected:!0,onClick:()=>{}},h.id))}),e.jsxs("div",{className:"card-actions",children:[e.jsx("button",{onClick:v,className:"btn-icon",disabled:j,title:"Prononcer",children:"🔊"}),e.jsx("button",{onClick:p,className:"btn-icon",title:"Modifier",children:"✏️"}),e.jsx("button",{onClick:f,className:"btn-icon",title:"Supprimer",children:"🗑️"})]})]}),e.jsx("div",{className:"card-face card-back",children:d?e.jsx("img",{src:d,alt:s.name}):e.jsx("p",{children:"Chargement de l'image..."})})]})})},$=({flashcards:s,categories:r,onEdit:t})=>{const{deleteFlashcard:l}=k(),[i,n]=a.useState(null),d=c=>{n(c)},u=async()=>{if(i)try{await l(i),n(null)}catch(c){console.error("Erreur lors de la suppression:",c)}},o=()=>{n(null)};return s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"Aucune flashcard disponible."}),e.jsx("p",{children:'Commencez par en créer une en appuyant sur le bouton "Nouvelle Flashcard" !'})]}):e.jsxs("div",{className:"flashcards-list",children:[s.map(c=>e.jsx(M,{flashcard:c,categories:r,onEdit:t,onDelete:d},c.id)),i&&e.jsx("div",{className:"delete-modal-overlay",children:e.jsxs("div",{className:"delete-modal",children:[e.jsx("h3",{children:"Confirmer la suppression"}),e.jsx("p",{children:"Êtes-vous sûr de vouloir supprimer cette flashcard ?"}),e.jsx("p",{children:"Cette action est irréversible."}),e.jsxs("div",{className:"delete-modal-actions",children:[e.jsx("button",{onClick:o,className:"btn-outline",children:"Annuler"}),e.jsx("button",{onClick:u,className:"btn-danger",children:"Supprimer"})]})]})})]})},G=({flashcard:s,categories:r,loading:t,onClose:l,onEdit:i,onNext:n})=>e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Flashcard Aléatoire"}),e.jsx("button",{className:"modal-close-btn",onClick:l,children:"✕"})]}),e.jsx("div",{className:"modal-content",children:t?e.jsx(w,{}):s?e.jsx(M,{flashcard:s,categories:r,onEdit:d=>{l(),i(d)},onDelete:()=>{}}):e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"Aucune flashcard disponible."}),e.jsx("p",{children:"Commencez par en créer une !"})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{onClick:l,className:"btn-outline",children:"Fermer"}),s&&e.jsx("button",{onClick:n,className:"btn-secondary",children:"Autre aléatoire"})]})]})}),F=({category:s,selected:r=!1,onClick:t,onDelete:l=null})=>{const i={backgroundColor:`${s.color}${r?"DD":"33"}`,borderColor:s.color},n=u=>{t(s.id)},d=u=>{u.stopPropagation(),l(s.id)};return e.jsxs("div",{className:`category-chip ${r?"selected":""}`,style:i,onClick:n,children:[e.jsx("span",{className:"category-chip-text",children:s.name}),l&&e.jsx("span",{className:"category-chip-close",onClick:d,children:"✕"})]})},W=()=>{const s=U(),{filteredFlashcards:r,loading:t,error:l,selectCategory:i,selectedCategoryId:n,getRandomFlashcard:d}=k(),{categories:u}=z(),[o,c]=a.useState(!1),[j,x]=a.useState(null),[v,p]=a.useState(!1),f=()=>{s("/create")},m=b=>{s(`/edit/${b}`)},h=b=>{i(b===n?null:b)},g=async()=>{p(!0),c(!0);try{const b=await d();x(b)}catch(b){console.error("Erreur lors de la récupération d'une flashcard aléatoire:",b)}finally{p(!1)}},E=()=>{c(!1),x(null)};return t?e.jsx(w,{}):e.jsxs("div",{className:"home-screen",children:[e.jsxs("div",{className:"home-header",children:[e.jsx("h1",{children:"Mes Flashcards d'Avions"}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:f,children:"➕ Nouvelle Flashcard"}),e.jsx("button",{onClick:g,className:"btn-secondary",children:"🎲 Flashcard Aléatoire"})]})]}),l&&e.jsx("p",{className:"error-text",children:l}),e.jsxs("div",{className:"categories-filter",children:[e.jsx("h3",{children:"Filtrer par catégorie:"}),e.jsxs("div",{className:"categories-list",children:[e.jsx(F,{category:{id:"all",name:"Toutes",color:"#808080"},selected:n===null,onClick:()=>i(null)}),u.map(b=>e.jsx(F,{category:b,selected:b.id===n,onClick:h},b.id))]})]}),e.jsx($,{flashcards:r,categories:u,onEdit:m}),o&&e.jsx(G,{flashcard:j,categories:u,loading:v,onClose:E,onEdit:m,onNext:g})]})},X=({initialImageUrl:s=null,onImageSelected:r})=>{const[t,l]=a.useState(s),i=a.useRef(null),n=()=>{i.current.click()},d=u=>{const o=u.target.files[0];if(!o)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(o.type)){alert("Veuillez sélectionner une image valide (JPEG, PNG, GIF, WebP)");return}const j=5*1024*1024;if(o.size>j){alert("L'image est trop volumineuse. Taille maximale: 5 Mo");return}const x=URL.createObjectURL(o);return l(x),r(o),()=>URL.revokeObjectURL(x)};return e.jsxs("div",{className:"image-picker",children:[e.jsx("input",{type:"file",ref:i,accept:"image/*",onChange:d,style:{display:"none"}}),e.jsx("div",{className:"image-preview",onClick:n,style:{backgroundImage:t?`url(${t})`:"none",backgroundColor:t?"transparent":"#f0f0f0"},children:!t&&e.jsxs("div",{className:"image-placeholder",children:[e.jsx("span",{children:"📷"}),e.jsx("p",{children:"Cliquez pour choisir une image"})]})}),e.jsx("button",{type:"button",className:"btn-outline image-select-btn",onClick:n,children:t?"Changer l'image":"Sélectionner une image"})]})},H=({initialFlashcard:s=null,initialImageUrl:r=null,onBack:t})=>{const l=U(),{addFlashcard:i,updateFlashcard:n,loading:d,error:u}=k(),{categories:o}=z(),[c,j]=a.useState((s==null?void 0:s.name)||""),[x,v]=a.useState(null),[p,f]=a.useState((s==null?void 0:s.categoryIds)||[]),[m,h]=a.useState(""),[g,E]=a.useState(!1),b=async N=>{if(N.preventDefault(),!c.trim()){h("Le nom de l'avion est requis");return}if(!x&&!s){h("Une image est requise");return}h(""),E(!0);try{s?await n(s.id,c.trim(),x,p):await i(c.trim(),x,p),l("/")}catch(S){console.error("Erreur lors de la sauvegarde:",S),h("Une erreur est survenue lors de la sauvegarde. Veuillez réessayer.")}finally{E(!1)}},R=N=>{f(S=>S.includes(N)?S.filter(A=>A!==N):[...S,N])},C=N=>{v(N)};return d?e.jsx(w,{}):e.jsxs("form",{onSubmit:b,className:"flashcard-form",children:[(u||m)&&e.jsx("div",{className:"error-message",children:u||m}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Nom de l'avion"}),e.jsx("input",{id:"name",type:"text",value:c,onChange:N=>j(N.target.value),placeholder:"Ex: Rafale, Mirage 2000, A380...",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Image de l'avion"}),e.jsx(X,{initialImageUrl:r,onImageSelected:C})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Catégories"}),e.jsx("div",{className:"categories-selection",children:o.length===0?e.jsx("p",{className:"info-text",children:'Aucune catégorie disponible. Créez-en dans la section "Catégories".'}):o.map(N=>e.jsx(F,{category:N,selected:p.includes(N.id),onClick:R},N.id))})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",onClick:t,className:"btn-outline",disabled:g,children:"Annuler"}),e.jsx("button",{type:"submit",disabled:g||!c.trim()||!x&&!s,children:g?"Enregistrement...":s?"Mettre à jour":"Créer"})]})]})},L=()=>{const{id:s}=J(),r=U(),{loading:t,getFlashcardById:l,getFlashcardImageUrl:i}=k(),[n,d]=a.useState(null),[u,o]=a.useState(null),[c,j]=a.useState(!!s);a.useEffect(()=>{(async()=>{if(s)try{j(!0);const p=await l(s);if(!p){r("/create",{replace:!0});return}if(d(p),p.imagePath){const f=await i(p.imagePath);o(f)}}catch(p){console.error("Erreur lors du chargement de la flashcard:",p)}finally{j(!1)}})()},[s,l,i,r]);const x=()=>{r(-1)};return c||t?e.jsx(w,{}):e.jsxs("div",{className:"create-screen",children:[e.jsx("h1",{children:s?"Modifier la flashcard":"Créer une nouvelle flashcard"}),e.jsx(H,{initialFlashcard:n,initialImageUrl:u,onBack:x})]})},P=["#1A73E8","#F57C00","#4CAF50","#F44336","#9C27B0","#FFEB3B","#607D8B","#E91E63","#795548","#009688","#3F51B5","#FF5722"],_=({category:s=null,onCancel:r,onSaveSuccess:t})=>{const{addCategory:l,updateCategory:i,error:n}=z(),[d,u]=a.useState((s==null?void 0:s.name)||""),[o,c]=a.useState((s==null?void 0:s.color)||P[0]),[j,x]=a.useState(""),[v,p]=a.useState(!1),f=async m=>{if(m.preventDefault(),!d.trim()){x("Le nom de la catégorie est requis");return}x(""),p(!0);try{s?await i(s.id,d.trim(),o):await l(d.trim(),o),t()}catch(h){console.error("Erreur lors de la sauvegarde:",h),x("Une erreur est survenue lors de la sauvegarde. Veuillez réessayer.")}finally{p(!1)}};return e.jsxs("form",{onSubmit:f,className:"category-form card",children:[e.jsx("h2",{children:s?"Modifier la catégorie":"Nouvelle catégorie"}),(n||j)&&e.jsx("div",{className:"error-message",children:n||j}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"category-name",children:"Nom de la catégorie"}),e.jsx("input",{id:"category-name",type:"text",value:d,onChange:m=>u(m.target.value),placeholder:"Ex: Avions français, Avions militaires, XXe siècle...",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Couleur"}),e.jsx("div",{className:"color-picker",children:P.map(m=>e.jsx("div",{className:`color-option ${o===m?"selected":""}`,style:{backgroundColor:m},onClick:()=>c(m)},m))})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",onClick:r,className:"btn-outline",disabled:v,children:"Annuler"}),e.jsx("button",{type:"submit",disabled:v||!d.trim(),children:v?"Enregistrement...":s?"Mettre à jour":"Créer"})]})]})},K=()=>{const{categories:s,loading:r,error:t,deleteCategory:l}=z(),[i,n]=a.useState(!1),[d,u]=a.useState(null),[o,c]=a.useState(null),j=()=>{u(null),n(!0)},x=g=>{u(g),n(!0)},v=()=>{u(null),n(!1)},p=()=>{u(null),n(!1)},f=g=>{c(g)},m=async()=>{if(o)try{await l(o.id),c(null)}catch(g){console.error("Erreur lors de la suppression:",g)}},h=()=>{c(null)};return r?e.jsx(w,{}):e.jsxs("div",{className:"categories-screen",children:[e.jsxs("div",{className:"categories-header",children:[e.jsx("h1",{children:"Gérer les catégories"}),!i&&e.jsx("button",{onClick:j,children:"➕ Nouvelle catégorie"})]}),t&&e.jsx("p",{className:"error-text",children:t}),i&&e.jsx(_,{category:d,onCancel:v,onSaveSuccess:p}),e.jsxs("div",{className:"categories-list-container",children:[e.jsx("h2",{children:"Catégories existantes"}),s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"Aucune catégorie n'a été créée."}),e.jsx("p",{children:'Créez votre première catégorie en cliquant sur "Nouvelle catégorie".'})]}):e.jsx("div",{className:"categories-grid",children:s.map(g=>e.jsxs("div",{className:"category-card",style:{borderColor:g.color},children:[e.jsx("div",{className:"category-color",style:{backgroundColor:g.color}}),e.jsx("div",{className:"category-info",children:e.jsx("h3",{children:g.name})}),e.jsxs("div",{className:"category-actions",children:[e.jsx("button",{onClick:()=>x(g),className:"btn-icon",title:"Modifier",children:"✏️"}),e.jsx("button",{onClick:()=>f(g),className:"btn-icon",title:"Supprimer",children:"🗑️"})]})]},g.id))})]}),o&&e.jsx("div",{className:"delete-modal-overlay",children:e.jsxs("div",{className:"delete-modal",children:[e.jsx("h3",{children:"Confirmer la suppression"}),e.jsxs("p",{children:['Êtes-vous sûr de vouloir supprimer la catégorie "',o.name,'" ?']}),e.jsx("p",{children:"Cette action retirera cette catégorie de toutes les flashcards associées."}),e.jsxs("div",{className:"delete-modal-actions",children:[e.jsx("button",{onClick:h,className:"btn-outline",children:"Annuler"}),e.jsx("button",{onClick:m,className:"btn-danger",children:"Supprimer"})]})]})})]})},Y=({flashcard:s,onCorrectAnswer:r,onNext:t})=>{const[l,i]=a.useState(""),[n,d]=a.useState(!1),[u,o]=a.useState(!1),[c,j]=a.useState(null),{getFlashcardImageUrl:x}=k(),{speak:v}=T();a.useEffect(()=>{(async()=>{if(s!=null&&s.imagePath){const h=await x(s.imagePath);j(h)}})(),i(""),d(!1),o(!1)},[s,x]);const p=m=>{if(m.preventDefault(),!l.trim()||n)return;const h=l.trim().toLowerCase()===s.name.toLowerCase();o(h),d(!0),h&&r(),v(s.name)},f=()=>{t()};return e.jsxs("div",{className:"quiz-card",children:[e.jsx("div",{className:"quiz-image-container",children:c?e.jsx("img",{src:c,alt:"Avion à identifier",className:"quiz-image"}):e.jsx("div",{className:"loading-placeholder",children:"Chargement de l'image..."})}),e.jsxs("form",{onSubmit:p,className:"quiz-form",children:[e.jsx("label",{htmlFor:"guess",children:"Quel est le nom de cet avion ?"}),e.jsxs("div",{className:"quiz-input-group",children:[e.jsx("input",{id:"guess",type:"text",value:l,onChange:m=>i(m.target.value),placeholder:"Entrez le nom de l'avion",disabled:n,autoComplete:"off"}),!n&&e.jsx("button",{type:"submit",disabled:!l.trim(),children:"Valider"})]})]}),n&&e.jsxs("div",{className:`quiz-result ${u?"correct":"incorrect"}`,children:[e.jsx("div",{className:"result-icon",children:u?"✓":"✗"}),e.jsx("div",{className:"result-message",children:u?"Correct !":`Incorrect. La réponse était : ${s.name}`}),e.jsx("button",{onClick:f,className:"btn-primary",children:"Question suivante"})]})]})},Z=()=>{const{flashcards:s,loading:r,error:t,selectedCategoryId:l,selectCategory:i}=k(),{categories:n}=z(),[d,u]=a.useState(!1),[o,c]=a.useState([]),[j,x]=a.useState(0),[v,p]=a.useState(0),[f,m]=a.useState(!1);a.useEffect(()=>{if(d&&s.length>0){let C=[...s];l&&(C=s.filter(S=>S.categoryIds.includes(l)));const N=[...C].sort(()=>Math.random()-.5);c(N),x(0),p(0),m(!1)}},[d,s,l]);const h=()=>{u(!0)},g=()=>{j<o.length-1?x(j+1):m(!0)},E=()=>{p(v+1)},b=()=>{u(!1),c([]),x(0),p(0),m(!1)},R=C=>{i(C===l?null:C)};if(r)return e.jsx(w,{});if(!d)return e.jsxs("div",{className:"quiz-setup-screen",children:[e.jsx("h1",{children:"Mode Quiz"}),t&&e.jsx("p",{className:"error-text",children:t}),e.jsxs("div",{className:"quiz-instructions",children:[e.jsx("p",{children:"Testez vos connaissances ! Le quiz vous montrera une image d'avion et vous devrez deviner son nom."}),e.jsx("p",{children:"Vous pouvez filtrer par catégorie ou jouer avec toutes les flashcards."})]}),e.jsxs("div",{className:"categories-filter",children:[e.jsx("h3",{children:"Filtrer par catégorie:"}),e.jsxs("div",{className:"categories-list",children:[e.jsx(F,{category:{id:"all",name:"Toutes",color:"#808080"},selected:l===null,onClick:()=>i(null)}),n.map(C=>e.jsx(F,{category:C,selected:C.id===l,onClick:R},C.id))]})]}),e.jsx("button",{onClick:h,disabled:s.length===0,className:"btn-primary btn-large",children:"Commencer le quiz"}),s.length===0&&e.jsx("p",{className:"info-text",children:"Vous devez créer des flashcards avant de pouvoir démarrer un quiz."})]});if(f){const C=o.length,N=Math.round(v/C*100);let S="";return N>=90?S="Excellent ! Vous êtes un expert !":N>=70?S="Très bien ! Vous avez de bonnes connaissances !":N>=50?S="Pas mal ! Continuez à apprendre !":S="Continuez à vous entraîner, vous allez progresser !",e.jsxs("div",{className:"quiz-results-screen",children:[e.jsx("h1",{children:"Résultats du quiz"}),e.jsxs("div",{className:"quiz-score-card",children:[e.jsx("h2",{children:"Score final"}),e.jsxs("div",{className:"score-display",children:[e.jsx("span",{className:"score-value",children:v}),e.jsx("span",{className:"score-separator",children:"/"}),e.jsx("span",{className:"score-total",children:C})]}),e.jsxs("div",{className:"score-percentage",children:[N,"%"]}),e.jsx("p",{className:"score-message",children:S})]}),e.jsxs("div",{className:"quiz-actions",children:[e.jsx("button",{onClick:b,className:"btn-outline",children:"Retour à l'accueil du quiz"}),e.jsx("button",{onClick:()=>{x(0),p(0),m(!1);const A=[...o].sort(()=>Math.random()-.5);c(A)},className:"btn-primary",children:"Recommencer"})]})]})}return e.jsxs("div",{className:"quiz-screen",children:[e.jsxs("div",{className:"quiz-header",children:[e.jsx("h1",{children:"Mode Quiz"}),e.jsxs("div",{className:"quiz-progress",children:["Question ",j+1," / ",o.length]})]}),e.jsxs("div",{className:"quiz-score",children:["Score: ",v]}),o.length>0&&j<o.length?e.jsx(Y,{flashcard:o[j],onCorrectAnswer:E,onNext:g}):e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"Aucune flashcard disponible pour ce quiz."}),e.jsx("button",{onClick:b,children:"Retour"})]})]})},I={exportToJson:s=>{try{return JSON.stringify(s,null,2)}catch(r){throw console.error("Erreur lors de l'export en JSON:",r),new Error("Impossible d'exporter les données en JSON")}},downloadJson:(s,r="avioncards-export")=>{try{const t=I.exportToJson(s),l=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(l),n=document.createElement("a");n.href=i,n.download=`${r}-${new Date().toISOString().substring(0,10)}.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}catch(t){throw console.error("Erreur lors du téléchargement JSON:",t),new Error("Impossible de créer le fichier d'export")}},importFromJson:s=>{try{return JSON.parse(s)}catch(r){throw console.error("Erreur lors de l'import JSON:",r),new Error("Format de fichier JSON invalide")}},readJsonFile:async s=>new Promise((r,t)=>{const l=new FileReader;l.onload=i=>{try{const n=I.importFromJson(i.target.result);r(n)}catch(n){t(n)}},l.onerror=()=>{t(new Error("Erreur lors de la lecture du fichier"))},l.readAsText(s)})},ee=()=>{const[s,r]=a.useState(!1),[t,l]=a.useState(!1),[i,n]=a.useState(!1),[d,u]=a.useState(!1),[o,c]=a.useState(null),j=a.useRef(null),x=async()=>{r(!0),c(null),n(!1);try{const f=await D.exportAllData();I.downloadJson(f,"avioncards-export"),n(!0),setTimeout(()=>{n(!1)},3e3)}catch(f){console.error("Erreur lors de l'export des données:",f),c("Une erreur est survenue lors de l'export des données. Veuillez réessayer.")}finally{r(!1)}},v=()=>{j.current.click()},p=async f=>{const m=f.target.files[0];if(m){l(!0),c(null),u(!1);try{const h=await I.readJsonFile(m);if(!h||!h.flashcards||!h.categories)throw new Error("Format de fichier invalide");await D.importAllData(h),u(!0),setTimeout(()=>{u(!1)},3e3),setTimeout(()=>{window.location.reload()},1500)}catch(h){console.error("Erreur lors de l'import des données:",h),c("Une erreur est survenue lors de l'import des données. Veuillez vérifier le format du fichier.")}finally{l(!1),f.target.value=null}}};return e.jsxs("div",{className:"import-export-section",children:[e.jsx("h2",{children:"Import / Export des données"}),e.jsx("p",{children:"Exportez vos données pour les sauvegarder ou les importer dans une autre installation."}),o&&e.jsx("p",{className:"error-text",children:o}),i&&e.jsx("p",{className:"success-text",children:"Export réussi ! Le fichier a été téléchargé."}),d&&e.jsx("p",{className:"success-text",children:"Import réussi ! La page va se recharger..."}),e.jsxs("div",{className:"buttons-group",children:[e.jsx("button",{onClick:x,disabled:s||t,className:"btn-primary",children:s?"Exportation...":"Exporter les données"}),e.jsx("button",{onClick:v,disabled:s||t,className:"btn-secondary",children:t?"Importation...":"Importer des données"}),e.jsx("input",{type:"file",ref:j,accept:".json",style:{display:"none"},onChange:p})]})]})},se=()=>e.jsxs("div",{className:"about-section",children:[e.jsx("h2",{children:"À propos d'AvionCards"}),e.jsxs("div",{className:"app-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Version:"})," 1.0.0"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," Application de flashcards sur le thème des avions"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Technologies:"})," React, IndexedDB, Web Speech API"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Stockage:"})," Toutes les données sont stockées localement dans votre navigateur"]})]}),e.jsxs("div",{className:"app-features",children:[e.jsx("h3",{children:"Fonctionnalités principales"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Création et gestion de flashcards d'avions"}),e.jsx("li",{children:"Organisation par catégories personnalisables"}),e.jsx("li",{children:"Mode quiz pour tester vos connaissances"}),e.jsx("li",{children:"Synthèse vocale pour la prononciation des noms d'avions"}),e.jsx("li",{children:"Sauvegarde et restauration des données"})]})]}),e.jsx("div",{className:"app-credits",children:e.jsx("p",{children:"© 2023 AvionCards - Tous droits réservés"})})]}),re=()=>{const[s,r]=a.useState(!1),[t,l]=a.useState(!1),[i,n]=a.useState(null),[d,u]=a.useState(!1),o=async()=>{l(!0),n(null);try{await D.clearAllData(),u(!0),r(!1),setTimeout(()=>{window.location.reload()},1500)}catch(c){console.error("Erreur lors de la réinitialisation des données:",c),n("Une erreur est survenue. Veuillez réessayer.")}finally{l(!1)}};return e.jsxs("div",{className:"settings-screen",children:[e.jsx("h1",{children:"Paramètres"}),e.jsx("div",{className:"settings-section",children:e.jsx(ee,{})}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h2",{children:"Réinitialisation des données"}),e.jsx("p",{children:"Cette action supprimera toutes vos flashcards et catégories. Cette opération est irréversible."}),e.jsx("button",{onClick:()=>r(!0),className:"btn-danger",children:"Réinitialiser toutes les données"}),d&&e.jsx("p",{className:"success-text",children:"Toutes les données ont été réinitialisées avec succès. La page va se recharger..."})]}),e.jsx("div",{className:"settings-section",children:e.jsx(se,{})}),s&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal danger-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Réinitialiser toutes les données ?"}),e.jsx("button",{className:"modal-close-btn",onClick:()=>r(!1),disabled:t,children:"✕"})]}),e.jsxs("div",{className:"modal-content",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Attention :"})," Cette action va supprimer définitivement toutes vos flashcards et catégories. Cette opération ne peut pas être annulée."]}),e.jsx("p",{children:"Êtes-vous absolument sûr de vouloir réinitialiser toutes les données ?"}),i&&e.jsx("p",{className:"error-text",children:i})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{onClick:()=>r(!1),className:"btn-outline",disabled:t,children:"Annuler"}),e.jsx("button",{onClick:o,className:"btn-danger",disabled:t,children:t?"Réinitialisation...":"Réinitialiser"})]})]})})]})},ne=()=>e.jsxs(Q,{children:[e.jsx(y,{path:"/",element:e.jsx(W,{})}),e.jsx(y,{path:"/create",element:e.jsx(L,{})}),e.jsx(y,{path:"/edit/:id",element:e.jsx(L,{})}),e.jsx(y,{path:"/categories",element:e.jsx(K,{})}),e.jsx(y,{path:"/quiz",element:e.jsx(Z,{})}),e.jsx(y,{path:"/settings",element:e.jsx(re,{})}),e.jsx(y,{path:"*",element:e.jsx(B,{to:"/",replace:!0})})]});export{ne as default};
